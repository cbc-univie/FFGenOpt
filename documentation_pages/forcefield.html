<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Generating Initial Force Fields &mdash; FFGenOpt  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using FFGenOpt" href="ffgenopt.html" />
    <link rel="prev" title="Quantum Mechanics Setup" href="qm.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            FFGenOpt
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="qm.html">Quantum Mechanics Setup</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Generating Initial Force Fields</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#non-polarizable-parameters">Non-polarizable parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#polarizable-parameters">Polarizable parameters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ffgenopt.html">Using FFGenOpt</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">FFGenOpt</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Generating Initial Force Fields</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/documentation_pages/forcefield.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="generating-initial-force-fields">
<span id="force-field"></span><h1>Generating Initial Force Fields<a class="headerlink" href="#generating-initial-force-fields" title="Permalink to this heading"></a></h1>
<p>If you already have a working CHARMM-formatted force field that you want to
refine using <strong>FFGenOpt</strong>, then you can skip ahead to
<a class="reference internal" href="ffgenopt.html#ffgenopt"><span class="std std-ref">using FFGenOpt</span></a>. Otherwise follow along to see how the initial
parameters for F<sub>3</sub>CCOO<sup>-</sup> are generated.</p>
<section id="non-polarizable-parameters">
<h2>Non-polarizable parameters<a class="headerlink" href="#non-polarizable-parameters" title="Permalink to this heading"></a></h2>
<p>First, we will generate an initial guess using the <a class="reference external" href="https://cgenff.umaryland.edu/">paramchem webserver </a> and a .mol2 file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using paramchem requires a free-of-charge registration and has a limit of
not more than 100 molecules per week.</p>
</div>
<p>For that, we will have to create a .mol2 file of trifluoroacetate. You can
either use Open Babel from the command line by typing</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>obabel<span class="w"> </span>-ixyz<span class="w"> </span>f3ccoo.xyz<span class="w"> </span>-omol2<span class="w"> </span>-Of3ccoo.mol2
</pre></div>
</div>
<p>or you can use avogadro to open the .xyz structure of your molecule and export
it as a .mol2 file. In either case, inspect the output of the conversion to
make sure that everything is sane (<em>e.g.</em> bond orders). Upload the structure
to <a class="reference external" href="https://cgenff.umaryland.edu/">paramchem</a> and make sure to check the
box <cite>Include parameters that are already in CGenFF</cite>. If everything went
smoothly, you should end up with a stream file that looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>* Toppar stream file generated by
* CHARMM General Force Field (CGenFF) program version 2.5
* For use with CGenFF version 4.6
*

read rtf card append
* Topologies generated by
* CHARMM General Force Field (CGenFF) program version 2.5
*
36 1

! &quot;penalty&quot; is the highest penalty score of the associated parameters.
! Penalties lower than 10 indicate the analogy is fair; penalties between 10
! and 50 mean some basic validation is recommended; penalties higher than
! 50 indicate poor analogy and mandate extensive validation/optimization.

RESI F3COO         -1.000 ! param penalty=  10.200 ; charge penalty=  37.514
GROUP            ! CHARGE   CH_PENALTY
ATOM C1     CG302   0.232 !   35.711
ATOM C2     CG2O3   0.731 !   37.514
ATOM F1     FGA3   -0.177 !   14.418
ATOM F2     FGA3   -0.177 !   14.418
ATOM F3     FGA3   -0.177 !   14.418
ATOM O1     OG2D2  -0.716 !    3.134
ATOM O2     OG2D2  -0.716 !    3.134

BOND C1   C2
BOND C1   F1
BOND C1   F2
BOND C1   F3
BOND C2   O1
BOND C2   O2
IMPR C2     O2     O1     C1

END

read param card flex append
* Parameters generated by analogy by
* CHARMM General Force Field (CGenFF) program version 2.5
*

! Penalties lower than 10 indicate the analogy is fair; penalties between 10
! and 50 mean some basic validation is recommended; penalties higher than
! 50 indicate poor analogy and mandate extensive validation/optimization.

BONDS
CG2O3  CG302   160.95     1.4556 ! ***** , from CG2O3 CG322, PENALTY= 10
CG2O3  OG2D2   525.00     1.2600 ! PROT adm jr. 7/23/91, acetic acid
CG302  FGA3    265.00     1.3400 ! FLUROALK fluoroalkanes

ANGLES
CG302  CG2O3  OG2D2    30.98    104.01   49.99   2.43700 ! ***** , from CG322 CG2O3 OG2D2, PENALTY= 3.2
OG2D2  CG2O3  OG2D2   100.00    128.00   70.00   2.25870 ! PROT adm jr. 7/23/91, correction, ACETATE (KK)
CG2O3  CG302  FGA3     47.24    106.59   30.03   2.49990 ! ***** , from CG2O3 CG322 FGA1, PENALTY= 10.2
FGA3   CG302  FGA3    118.00    107.00   30.00   2.15500 ! FLUROALK fluoroalkanes

DIHEDRALS
OG2D2  CG2O3  CG302  FGA3       0.8107  2   180.00 ! ***** , from OG2D2 CG2O3 CG322 FGA1, PENALTY= 10.2

IMPROPERS
CG2O3  OG2D2  OG2D2  CG302     96.0000  0     0.00 ! ***** , from CG2O3 OG2D2 OG2D2 CG322, PENALTY= 1

END
RETURN
</pre></div>
</div>
<p>This serves as the basis for our polarizable force field. You can either
convert to polarizable atom types by analogy or use an automated tool. The
<a class="reference external" href="http://ffparam.umaryland.edu/download.php">ffparam</a> utility provides a GUI
and a documentation detailing how to validate parameters with a high penalty.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Since <strong>ffparam</strong> can be picky about the different software versions it needs
(e.g. not working with python 3.8 or higher), you could use the following
.yml file to build a conda env.</p>
</div>
<p>Modify the path in the last line of this file to point to your conda install:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name</span><span class="p">:</span> <span class="n">ffpenv</span>
<span class="n">channels</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">anaconda</span>
  <span class="o">-</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span>
  <span class="o">-</span> <span class="n">defaults</span>
<span class="n">dependencies</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">_libgcc_mutex</span><span class="o">=</span><span class="mf">0.1</span><span class="o">=</span><span class="n">conda_forge</span>
  <span class="o">-</span> <span class="n">_openmp_mutex</span><span class="o">=</span><span class="mf">4.5</span><span class="o">=</span><span class="mi">1</span><span class="n">_gnu</span>
  <span class="o">-</span> <span class="n">alsa</span><span class="o">-</span><span class="n">lib</span><span class="o">=</span><span class="mf">1.2.3</span><span class="o">=</span><span class="n">h516909a_0</span>
  <span class="o">-</span> <span class="n">bcrypt</span><span class="o">=</span><span class="mf">3.2.0</span><span class="o">=</span><span class="n">py37h7b6447c_0</span>
  <span class="o">-</span> <span class="n">boost</span><span class="o">=</span><span class="mf">1.70.0</span><span class="o">=</span><span class="n">py37h9de70de_1</span>
  <span class="o">-</span> <span class="n">boost</span><span class="o">-</span><span class="n">cpp</span><span class="o">=</span><span class="mf">1.70.0</span><span class="o">=</span><span class="n">ha2d47e9_1</span>
  <span class="o">-</span> <span class="n">bzip2</span><span class="o">=</span><span class="mf">1.0.8</span><span class="o">=</span><span class="n">h7f98852_4</span>
  <span class="o">-</span> <span class="n">ca</span><span class="o">-</span><span class="n">certificates</span><span class="o">=</span><span class="mf">2023.5.7</span><span class="o">=</span><span class="n">hbcca054_0</span>
  <span class="o">-</span> <span class="n">cairo</span><span class="o">=</span><span class="mf">1.16.0</span><span class="o">=</span><span class="n">hb05425b_3</span>
  <span class="o">-</span> <span class="n">certifi</span><span class="o">=</span><span class="mf">2023.5.7</span><span class="o">=</span><span class="n">pyhd8ed1ab_0</span>
  <span class="o">-</span> <span class="n">cffi</span><span class="o">=</span><span class="mf">1.15.1</span><span class="o">=</span><span class="n">py37h43b0acd_1</span>
  <span class="o">-</span> <span class="n">cryptography</span><span class="o">=</span><span class="mf">38.0.2</span><span class="o">=</span><span class="n">py37h5994e8b_1</span>
  <span class="o">-</span> <span class="n">cudatoolkit</span><span class="o">=</span><span class="mf">11.8.0</span><span class="o">=</span><span class="n">h37601d7_11</span>
  <span class="o">-</span> <span class="n">cycler</span><span class="o">=</span><span class="mf">0.10.0</span><span class="o">=</span><span class="n">py_2</span>
  <span class="o">-</span> <span class="n">dbus</span><span class="o">=</span><span class="mf">1.13.6</span><span class="o">=</span><span class="n">h48d8840_2</span>
  <span class="o">-</span> <span class="n">expat</span><span class="o">=</span><span class="mf">2.4.1</span><span class="o">=</span><span class="n">h9c3ff4c_0</span>
  <span class="o">-</span> <span class="n">fftw</span><span class="o">=</span><span class="mf">3.3.10</span><span class="o">=</span><span class="n">nompi_hf0379b8_106</span>
  <span class="o">-</span> <span class="n">fontconfig</span><span class="o">=</span><span class="mf">2.14.1</span><span class="o">=</span><span class="n">hef1e5e3_0</span>
  <span class="o">-</span> <span class="n">freeglut</span><span class="o">=</span><span class="mf">3.2.1</span><span class="o">=</span><span class="n">h9c3ff4c_2</span>
  <span class="o">-</span> <span class="n">freetype</span><span class="o">=</span><span class="mf">2.10.4</span><span class="o">=</span><span class="n">h0708190_1</span>
  <span class="o">-</span> <span class="n">gettext</span><span class="o">=</span><span class="mf">0.21.1</span><span class="o">=</span><span class="n">h27087fc_0</span>
  <span class="o">-</span> <span class="n">glib</span><span class="o">=</span><span class="mf">2.76.2</span><span class="o">=</span><span class="n">hfc55251_0</span>
  <span class="o">-</span> <span class="n">glib</span><span class="o">-</span><span class="n">tools</span><span class="o">=</span><span class="mf">2.76.2</span><span class="o">=</span><span class="n">hfc55251_0</span>
  <span class="o">-</span> <span class="n">greenlet</span><span class="o">=</span><span class="mf">1.1.1</span><span class="o">=</span><span class="n">py37hcd2ae1e_0</span>
  <span class="o">-</span> <span class="n">gst</span><span class="o">-</span><span class="n">plugins</span><span class="o">-</span><span class="n">base</span><span class="o">=</span><span class="mf">1.14.1</span><span class="o">=</span><span class="n">h6a678d5_1</span>
  <span class="o">-</span> <span class="n">gstreamer</span><span class="o">=</span><span class="mf">1.14.1</span><span class="o">=</span><span class="n">h5eee18b_1</span>
  <span class="o">-</span> <span class="n">icu</span><span class="o">=</span><span class="mf">58.2</span><span class="o">=</span><span class="n">hf484d3e_1000</span>
  <span class="o">-</span> <span class="n">importlib</span><span class="o">-</span><span class="n">metadata</span><span class="o">=</span><span class="mf">4.8.1</span><span class="o">=</span><span class="n">py37h89c1867_0</span>
  <span class="o">-</span> <span class="n">jbig</span><span class="o">=</span><span class="mf">2.1</span><span class="o">=</span><span class="n">h7f98852_2003</span>
  <span class="o">-</span> <span class="n">jpeg</span><span class="o">=</span><span class="mi">9</span><span class="n">d</span><span class="o">=</span><span class="n">h36c2ea0_0</span>
  <span class="o">-</span> <span class="n">keyutils</span><span class="o">=</span><span class="mf">1.6.1</span><span class="o">=</span><span class="n">h166bdaf_0</span>
  <span class="o">-</span> <span class="n">kiwisolver</span><span class="o">=</span><span class="mf">1.3.2</span><span class="o">=</span><span class="n">py37h2527ec5_0</span>
  <span class="o">-</span> <span class="n">krb5</span><span class="o">=</span><span class="mf">1.20.1</span><span class="o">=</span><span class="n">h81ceb04_0</span>
  <span class="o">-</span> <span class="n">lcms2</span><span class="o">=</span><span class="mf">2.12</span><span class="o">=</span><span class="n">hddcbb42_0</span>
  <span class="o">-</span> <span class="n">ld_impl_linux</span><span class="o">-</span><span class="mi">64</span><span class="o">=</span><span class="mf">2.36.1</span><span class="o">=</span><span class="n">hea4e1c9_2</span>
  <span class="o">-</span> <span class="n">lerc</span><span class="o">=</span><span class="mf">2.2.1</span><span class="o">=</span><span class="n">h9c3ff4c_0</span>
  <span class="o">-</span> <span class="n">libblas</span><span class="o">=</span><span class="mf">3.9.0</span><span class="o">=</span><span class="mi">11</span><span class="n">_linux64_openblas</span>
  <span class="o">-</span> <span class="n">libcblas</span><span class="o">=</span><span class="mf">3.9.0</span><span class="o">=</span><span class="mi">11</span><span class="n">_linux64_openblas</span>
  <span class="o">-</span> <span class="n">libclang</span><span class="o">=</span><span class="mf">11.1.0</span><span class="o">=</span><span class="n">default_ha53f305_1</span>
  <span class="o">-</span> <span class="n">libdeflate</span><span class="o">=</span><span class="mf">1.7</span><span class="o">=</span><span class="n">h7f98852_5</span>
  <span class="o">-</span> <span class="n">libedit</span><span class="o">=</span><span class="mf">3.1.20191231</span><span class="o">=</span><span class="n">he28a2e2_2</span>
  <span class="o">-</span> <span class="n">libevent</span><span class="o">=</span><span class="mf">2.1.12</span><span class="o">=</span><span class="n">h3358134_0</span>
  <span class="o">-</span> <span class="n">libffi</span><span class="o">=</span><span class="mf">3.4.2</span><span class="o">=</span><span class="n">h7f98852_5</span>
  <span class="o">-</span> <span class="n">libgcc</span><span class="o">-</span><span class="n">ng</span><span class="o">=</span><span class="mf">12.2.0</span><span class="o">=</span><span class="n">h65d4601_19</span>
  <span class="o">-</span> <span class="n">libgfortran</span><span class="o">-</span><span class="n">ng</span><span class="o">=</span><span class="mf">11.1.0</span><span class="o">=</span><span class="n">h69a702a_8</span>
  <span class="o">-</span> <span class="n">libgfortran5</span><span class="o">=</span><span class="mf">11.1.0</span><span class="o">=</span><span class="n">h6c583b3_8</span>
  <span class="o">-</span> <span class="n">libglib</span><span class="o">=</span><span class="mf">2.76.2</span><span class="o">=</span><span class="n">hebfc3b9_0</span>
  <span class="o">-</span> <span class="n">libgomp</span><span class="o">=</span><span class="mf">12.2.0</span><span class="o">=</span><span class="n">h65d4601_19</span>
  <span class="o">-</span> <span class="n">libiconv</span><span class="o">=</span><span class="mf">1.17</span><span class="o">=</span><span class="n">h166bdaf_0</span>
  <span class="o">-</span> <span class="n">liblapack</span><span class="o">=</span><span class="mf">3.9.0</span><span class="o">=</span><span class="mi">11</span><span class="n">_linux64_openblas</span>
  <span class="o">-</span> <span class="n">libllvm11</span><span class="o">=</span><span class="mf">11.1.0</span><span class="o">=</span><span class="n">hf817b99_2</span>
  <span class="o">-</span> <span class="n">libnsl</span><span class="o">=</span><span class="mf">2.0.0</span><span class="o">=</span><span class="n">h7f98852_0</span>
  <span class="o">-</span> <span class="n">libogg</span><span class="o">=</span><span class="mf">1.3.4</span><span class="o">=</span><span class="n">h7f98852_1</span>
  <span class="o">-</span> <span class="n">libopenblas</span><span class="o">=</span><span class="mf">0.3.17</span><span class="o">=</span><span class="n">pthreads_h8fe5266_1</span>
  <span class="o">-</span> <span class="n">libopus</span><span class="o">=</span><span class="mf">1.3.1</span><span class="o">=</span><span class="n">h7f98852_1</span>
  <span class="o">-</span> <span class="n">libpng</span><span class="o">=</span><span class="mf">1.6.37</span><span class="o">=</span><span class="n">h21135ba_2</span>
  <span class="o">-</span> <span class="n">libpq</span><span class="o">=</span><span class="mf">15.2</span><span class="o">=</span><span class="n">hb675445_0</span>
  <span class="o">-</span> <span class="n">libsodium</span><span class="o">=</span><span class="mf">1.0.18</span><span class="o">=</span><span class="n">h7b6447c_0</span>
  <span class="o">-</span> <span class="n">libstdcxx</span><span class="o">-</span><span class="n">ng</span><span class="o">=</span><span class="mf">12.2.0</span><span class="o">=</span><span class="n">h46fd767_19</span>
  <span class="o">-</span> <span class="n">libtiff</span><span class="o">=</span><span class="mf">4.3.0</span><span class="o">=</span><span class="n">hf544144_1</span>
  <span class="o">-</span> <span class="n">libuuid</span><span class="o">=</span><span class="mf">2.32.1</span><span class="o">=</span><span class="n">h7f98852_1000</span>
  <span class="o">-</span> <span class="n">libvorbis</span><span class="o">=</span><span class="mf">1.3.7</span><span class="o">=</span><span class="n">h9c3ff4c_0</span>
  <span class="o">-</span> <span class="n">libwebp</span><span class="o">-</span><span class="n">base</span><span class="o">=</span><span class="mf">1.2.1</span><span class="o">=</span><span class="n">h7f98852_0</span>
  <span class="o">-</span> <span class="n">libxcb</span><span class="o">=</span><span class="mf">1.15</span><span class="o">=</span><span class="n">h0b41bf4_0</span>
  <span class="o">-</span> <span class="n">libxkbcommon</span><span class="o">=</span><span class="mf">1.0.3</span><span class="o">=</span><span class="n">he3ba5ed_0</span>
  <span class="o">-</span> <span class="n">libxml2</span><span class="o">=</span><span class="mf">2.9.14</span><span class="o">=</span><span class="n">h74e7548_0</span>
  <span class="o">-</span> <span class="n">libxslt</span><span class="o">=</span><span class="mf">1.1.32</span><span class="o">=</span><span class="n">hae48121_1003</span>
  <span class="o">-</span> <span class="n">libzlib</span><span class="o">=</span><span class="mf">1.2.13</span><span class="o">=</span><span class="n">h166bdaf_4</span>
  <span class="o">-</span> <span class="n">lz4</span><span class="o">-</span><span class="n">c</span><span class="o">=</span><span class="mf">1.9.3</span><span class="o">=</span><span class="n">h9c3ff4c_1</span>
  <span class="o">-</span> <span class="n">matplotlib</span><span class="o">-</span><span class="n">base</span><span class="o">=</span><span class="mf">3.4.3</span><span class="o">=</span><span class="n">py37h1058ff1_0</span>
  <span class="o">-</span> <span class="n">mysql</span><span class="o">-</span><span class="n">common</span><span class="o">=</span><span class="mf">8.0.32</span><span class="o">=</span><span class="n">hf1915f5_2</span>
  <span class="o">-</span> <span class="n">mysql</span><span class="o">-</span><span class="n">libs</span><span class="o">=</span><span class="mf">8.0.32</span><span class="o">=</span><span class="n">hca2cd23_2</span>
  <span class="o">-</span> <span class="n">ncurses</span><span class="o">=</span><span class="mf">6.2</span><span class="o">=</span><span class="n">h58526e2_4</span>
  <span class="o">-</span> <span class="n">nspr</span><span class="o">=</span><span class="mf">4.30</span><span class="o">=</span><span class="n">h9c3ff4c_0</span>
  <span class="o">-</span> <span class="n">nss</span><span class="o">=</span><span class="mf">3.69</span><span class="o">=</span><span class="n">hb5efdd6_0</span>
  <span class="o">-</span> <span class="n">numpy</span><span class="o">=</span><span class="mf">1.21.2</span><span class="o">=</span><span class="n">py37h31617e3_0</span>
  <span class="o">-</span> <span class="n">ocl</span><span class="o">-</span><span class="n">icd</span><span class="o">=</span><span class="mf">2.3.1</span><span class="o">=</span><span class="n">h7f98852_0</span>
  <span class="o">-</span> <span class="n">ocl</span><span class="o">-</span><span class="n">icd</span><span class="o">-</span><span class="n">system</span><span class="o">=</span><span class="mf">1.0.0</span><span class="o">=</span><span class="mi">1</span>
  <span class="o">-</span> <span class="n">olefile</span><span class="o">=</span><span class="mf">0.46</span><span class="o">=</span><span class="n">pyh9f0ad1d_1</span>
  <span class="o">-</span> <span class="n">openjpeg</span><span class="o">=</span><span class="mf">2.4.0</span><span class="o">=</span><span class="n">hb52868f_1</span>
  <span class="o">-</span> <span class="n">openmm</span><span class="o">=</span><span class="mf">7.5.1</span><span class="o">=</span><span class="n">py37h96c4ddf_1</span>
  <span class="o">-</span> <span class="n">openssl</span><span class="o">=</span><span class="mf">3.1.0</span><span class="o">=</span><span class="n">hd590300_3</span>
  <span class="o">-</span> <span class="n">pandas</span><span class="o">=</span><span class="mf">1.3.2</span><span class="o">=</span><span class="n">py37he8f5f7f_0</span>
  <span class="o">-</span> <span class="n">paramiko</span><span class="o">=</span><span class="mf">2.7.2</span><span class="o">=</span><span class="n">py_0</span>
  <span class="o">-</span> <span class="n">pcre</span><span class="o">=</span><span class="mf">8.45</span><span class="o">=</span><span class="n">h9c3ff4c_0</span>
  <span class="o">-</span> <span class="n">pcre2</span><span class="o">=</span><span class="mf">10.40</span><span class="o">=</span><span class="n">hc3806b6_0</span>
  <span class="o">-</span> <span class="n">pillow</span><span class="o">=</span><span class="mf">8.0.0</span><span class="o">=</span><span class="n">py37h9a89aac_0</span>
  <span class="o">-</span> <span class="n">pip</span><span class="o">=</span><span class="mf">21.2.4</span><span class="o">=</span><span class="n">pyhd8ed1ab_0</span>
  <span class="o">-</span> <span class="n">pixman</span><span class="o">=</span><span class="mf">0.40.0</span><span class="o">=</span><span class="n">h36c2ea0_0</span>
  <span class="o">-</span> <span class="n">pthread</span><span class="o">-</span><span class="n">stubs</span><span class="o">=</span><span class="mf">0.4</span><span class="o">=</span><span class="n">h36c2ea0_1001</span>
  <span class="o">-</span> <span class="n">pycairo</span><span class="o">=</span><span class="mf">1.20.1</span><span class="o">=</span><span class="n">py37hfff247e_0</span>
  <span class="o">-</span> <span class="n">pycparser</span><span class="o">=</span><span class="mf">2.20</span><span class="o">=</span><span class="n">py_2</span>
  <span class="o">-</span> <span class="n">pynacl</span><span class="o">=</span><span class="mf">1.4.0</span><span class="o">=</span><span class="n">py37h7b6447c_1</span>
  <span class="o">-</span> <span class="n">pyparsing</span><span class="o">=</span><span class="mf">2.4.7</span><span class="o">=</span><span class="n">pyh9f0ad1d_0</span>
  <span class="o">-</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.7.12</span><span class="o">=</span><span class="n">hf930737_100_cpython</span>
  <span class="o">-</span> <span class="n">python</span><span class="o">-</span><span class="n">dateutil</span><span class="o">=</span><span class="mf">2.8.2</span><span class="o">=</span><span class="n">pyhd8ed1ab_0</span>
  <span class="o">-</span> <span class="n">python_abi</span><span class="o">=</span><span class="mf">3.7</span><span class="o">=</span><span class="mi">2</span><span class="n">_cp37m</span>
  <span class="o">-</span> <span class="n">pytz</span><span class="o">=</span><span class="mf">2021.1</span><span class="o">=</span><span class="n">pyhd8ed1ab_0</span>
  <span class="o">-</span> <span class="n">qt</span><span class="o">=</span><span class="mf">5.6.3</span><span class="o">=</span><span class="n">h8bf5577_3</span>
  <span class="o">-</span> <span class="n">rdkit</span><span class="o">=</span><span class="mf">2019.09.3</span><span class="o">=</span><span class="n">py37hb31dc5d_0</span>
  <span class="o">-</span> <span class="n">readline</span><span class="o">=</span><span class="mf">8.1</span><span class="o">=</span><span class="n">h46c0cb4_0</span>
  <span class="o">-</span> <span class="n">reportlab</span><span class="o">=</span><span class="mf">3.5.68</span><span class="o">=</span><span class="n">py37h69800bb_0</span>
  <span class="o">-</span> <span class="n">setuptools</span><span class="o">=</span><span class="mf">57.4.0</span><span class="o">=</span><span class="n">py37h89c1867_0</span>
  <span class="o">-</span> <span class="n">six</span><span class="o">=</span><span class="mf">1.16.0</span><span class="o">=</span><span class="n">pyh6c4a22f_0</span>
  <span class="o">-</span> <span class="n">sqlalchemy</span><span class="o">=</span><span class="mf">1.4.23</span><span class="o">=</span><span class="n">py37h5e8e339_0</span>
  <span class="o">-</span> <span class="n">sqlite</span><span class="o">=</span><span class="mf">3.36.0</span><span class="o">=</span><span class="n">h9cd32fc_0</span>
  <span class="o">-</span> <span class="n">tk</span><span class="o">=</span><span class="mf">8.6.11</span><span class="o">=</span><span class="n">h27826a3_1</span>
  <span class="o">-</span> <span class="n">tornado</span><span class="o">=</span><span class="mf">6.1</span><span class="o">=</span><span class="n">py37h5e8e339_1</span>
  <span class="o">-</span> <span class="n">typing_extensions</span><span class="o">=</span><span class="mf">3.10.0.0</span><span class="o">=</span><span class="n">pyha770c72_0</span>
  <span class="o">-</span> <span class="n">wheel</span><span class="o">=</span><span class="mf">0.37.0</span><span class="o">=</span><span class="n">pyhd8ed1ab_1</span>
  <span class="o">-</span> <span class="n">xorg</span><span class="o">-</span><span class="n">fixesproto</span><span class="o">=</span><span class="mf">5.0</span><span class="o">=</span><span class="n">h7f98852_1002</span>
  <span class="o">-</span> <span class="n">xorg</span><span class="o">-</span><span class="n">inputproto</span><span class="o">=</span><span class="mf">2.3.2</span><span class="o">=</span><span class="n">h7f98852_1002</span>
  <span class="o">-</span> <span class="n">xorg</span><span class="o">-</span><span class="n">kbproto</span><span class="o">=</span><span class="mf">1.0.7</span><span class="o">=</span><span class="n">h7f98852_1002</span>
  <span class="o">-</span> <span class="n">xorg</span><span class="o">-</span><span class="n">libice</span><span class="o">=</span><span class="mf">1.0.10</span><span class="o">=</span><span class="n">h7f98852_0</span>
  <span class="o">-</span> <span class="n">xorg</span><span class="o">-</span><span class="n">libsm</span><span class="o">=</span><span class="mf">1.2.3</span><span class="o">=</span><span class="n">hd9c2040_1000</span>
  <span class="o">-</span> <span class="n">xorg</span><span class="o">-</span><span class="n">libx11</span><span class="o">=</span><span class="mf">1.7.2</span><span class="o">=</span><span class="n">h7f98852_0</span>
  <span class="o">-</span> <span class="n">xorg</span><span class="o">-</span><span class="n">libxau</span><span class="o">=</span><span class="mf">1.0.9</span><span class="o">=</span><span class="n">h7f98852_0</span>
  <span class="o">-</span> <span class="n">xorg</span><span class="o">-</span><span class="n">libxdmcp</span><span class="o">=</span><span class="mf">1.1.3</span><span class="o">=</span><span class="n">h7f98852_0</span>
  <span class="o">-</span> <span class="n">xorg</span><span class="o">-</span><span class="n">libxext</span><span class="o">=</span><span class="mf">1.3.4</span><span class="o">=</span><span class="n">h7f98852_1</span>
  <span class="o">-</span> <span class="n">xorg</span><span class="o">-</span><span class="n">libxfixes</span><span class="o">=</span><span class="mf">5.0.3</span><span class="o">=</span><span class="n">h7f98852_1004</span>
  <span class="o">-</span> <span class="n">xorg</span><span class="o">-</span><span class="n">libxi</span><span class="o">=</span><span class="mf">1.7.10</span><span class="o">=</span><span class="n">h7f98852_0</span>
  <span class="o">-</span> <span class="n">xorg</span><span class="o">-</span><span class="n">libxrender</span><span class="o">=</span><span class="mf">0.9.10</span><span class="o">=</span><span class="n">h7f98852_1003</span>
  <span class="o">-</span> <span class="n">xorg</span><span class="o">-</span><span class="n">renderproto</span><span class="o">=</span><span class="mf">0.11.1</span><span class="o">=</span><span class="n">h7f98852_1002</span>
  <span class="o">-</span> <span class="n">xorg</span><span class="o">-</span><span class="n">xextproto</span><span class="o">=</span><span class="mf">7.3.0</span><span class="o">=</span><span class="n">h7f98852_1002</span>
  <span class="o">-</span> <span class="n">xorg</span><span class="o">-</span><span class="n">xproto</span><span class="o">=</span><span class="mf">7.0.31</span><span class="o">=</span><span class="n">h7f98852_1007</span>
  <span class="o">-</span> <span class="n">xz</span><span class="o">=</span><span class="mf">5.2.5</span><span class="o">=</span><span class="n">h516909a_1</span>
  <span class="o">-</span> <span class="n">zipp</span><span class="o">=</span><span class="mf">3.5.0</span><span class="o">=</span><span class="n">pyhd8ed1ab_0</span>
  <span class="o">-</span> <span class="n">zlib</span><span class="o">=</span><span class="mf">1.2.13</span><span class="o">=</span><span class="n">h166bdaf_4</span>
  <span class="o">-</span> <span class="n">zstd</span><span class="o">=</span><span class="mf">1.5.2</span><span class="o">=</span><span class="n">h3eb15da_6</span>
  <span class="o">-</span> <span class="n">pip</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">ffparam</span><span class="o">==</span><span class="mf">1.0.0</span>
      <span class="o">-</span> <span class="n">pyopengl</span><span class="o">==</span><span class="mf">3.1.5</span>
      <span class="o">-</span> <span class="n">pyside2</span><span class="o">==</span><span class="mf">5.15.2</span>
      <span class="o">-</span> <span class="n">shiboken2</span><span class="o">==</span><span class="mf">5.15.2</span>
<span class="n">prefix</span><span class="p">:</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">your</span><span class="o">/</span><span class="n">conda</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">ffpenv</span>
</pre></div>
</div>
<p>Then create a new environment via</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>ffepnv.yml
</pre></div>
</div>
<p>After that, build and install <strong>ffparam</strong> from source and finally install
pyside2 manually in the new conda env by running</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>install<span class="w"> </span>-n<span class="w"> </span>ffpenv<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span>pyside2
</pre></div>
</div>
<p>Activate the new conda environment -
if everything went smoothly, the <code class="docutils literal notranslate"><span class="pre">ffparam-gui</span></code> command should present you
with a window and you’ll be ready to start parametrizing.</p>
</section>
<section id="polarizable-parameters">
<h2>Polarizable parameters<a class="headerlink" href="#polarizable-parameters" title="Permalink to this heading"></a></h2>
<p>We could go ahead and reassign partial charges, but the focus of this exercise
is the tuning of bonded parameters. For this reason, we will simply use these
values and convert them via <strong>ffparam</strong>.</p>
<img alt="../_images/ffp1_hints.png" src="../_images/ffp1_hints.png" />
<p>The final stream file then has the
following lines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>* Toppar stream file generated by FFParam cgenfftoconverter
* For use with Drude force field
*

ioformat extended

read rtf card append
* Topologies generated by FFParam cgenfftoconverter
* For use with Drude force field
*
44

AUTO ANGL DIHE DRUD

! Converts cgenff atomtype to drude atom types.
! Charges are picked from cgenff stream file
! Alpha and Thole values are picked from first match of atom type in a text file containing all currently available residues.
! If it cannot find the values -1.0 and -1.3 values are assigned to the atom type.

RESI  F3COO     -1.0000
GROUP
ATOM C1     CD30A          0.232  ALPHA   0.0000  THOLE   0.0000
ATOM C2     CD2O2A         0.731  ALPHA   -1.0160  THOLE   0.8990
ATOM F1     FDA3          -0.177  ALPHA   -1.0000  THOLE   1.3000
ATOM F2     FDA3          -0.177  ALPHA   -1.0000  THOLE   1.3000
ATOM F3     FDA3          -0.177  ALPHA   -1.0000  THOLE   1.3000
ATOM O1     OD2C2A         0.000  ALPHA   -0.6990  THOLE   2.3990 ! You may also consider OD2C1C  OD2C3A Equivalent Atomtypes
ATOM O2     OD2C2A         0.000  ALPHA   -0.6990  THOLE   2.3990 ! You may also consider OD2C1C  OD2C3A Equivalent Atomtypes
ATOM LPO11  LPDO1         -0.358
ATOM LPO12  LPDO1         -0.358
ATOM LPO21  LPDO1         -0.358
ATOM LPO22  LPDO1         -0.358

BOND C1  C2
BOND C1  F1
BOND C1  F2
BOND C1  F3
BOND C2  O1
BOND C2  O2
BOND  LPO11  O1
BOND  LPO12  O1
BOND  LPO21  O2
BOND  LPO22  O2

LONE RELATIVE LPO11  O1  C2  C1 DIST 0.3500 ANGLE  110.00 DIHE    0.00
LONE RELATIVE LPO12  O1  C2  C1 DIST 0.3500 ANGLE  110.00 DIHE  180.00
LONE RELATIVE LPO21  O2  C2  C1 DIST 0.3500 ANGLE  110.00 DIHE    0.00
LONE RELATIVE LPO22  O2  C2  C1 DIST 0.3500 ANGLE  110.00 DIHE  180.00
END


read param card append
* Parameters generated by FFParam cgenfftoconverter
* For use with Drude force field
*

! Parameters are picked from same text file containing all currently available parameters.
! Similar approach like cgenff is applied, but it is not checked for its robustness.

BONDS
CD30A   CD2O2A   410.000  1.360   ! from CD2R5A CD2R5A  PENALTY 14.000
CD30A   FDA3   200.000  1.810   ! from CD32A SD2C2B  PENALTY 25.000

ANGLES
CD2O2A   CD30A   FDA3   43.000  113.200   ! from CD32A CD32A SD31B  PENALTY 44.000
FDA3   CD30A   FDA3   45.000  116.500   ! from OD305A CD30FA OD31E  PENALTY 157.000
CD30A   CD2O2A   OD2C2A   40.000  109.300   ! from CD31A CD2O2A OD2C2A  PENALTY  2.000

DIHEDRALS
FDA3   CD30A   CD2O2A   OD2C2A   0.438  1  180.000   ! from OD31A CD32A CD30FA OD31E  PENALTY 121.000
FDA3   CD30A   CD2O2A   OD2C2A   0.587  2  180.000   ! from OD31A CD32A CD30FA OD31E  PENALTY 121.000
FDA3   CD30A   CD2O2A   OD2C2A   0.382  3  180.000   ! from OD31A CD32A CD30FA OD31E  PENALTY 121.000
FDA3   CD30A   CD2O2A   OD2C2A   0.127  6  180.000   ! from OD31A CD32A CD30FA OD31E  PENALTY 121.000

IMPROPERS


END
RETURN
</pre></div>
</div>
<p>If you have access to <strong>CHARMM</strong>, then you have everything you need to generate
a .psf file and coordinates for F<sub>3</sub>CCOO<sup>-</sup>.
You can skip ahead to using <strong>FFGenOpt</strong>.
If that is not the case, then we will have to jump through some additional hoops
to create these files.</p>
<p>First, load the topology of the molecule from the newly generated polarizable
stream file. Then hit the <em>Fetch MM Prerequisites</em> and the
<em>Generate Initial Coordinates</em> buttons.</p>
<img alt="../_images/ffp2_hints.png" src="../_images/ffp2_hints.png" />
<p>Extract the optimized geometry of trifluoroacetate from the Psi4 output
using the <em>ExtractQMResult</em> tab. Make sure to check Psi4 and specify
<em>cartesian_geom</em> in the dropdown menu. This will create a <strong>CHARMM</strong>-formatted
coordinate file where atom names may or may not be correct.</p>
<img alt="../_images/ffp3_hints.png" src="../_images/ffp3_hints.png" />
<p>Next, switch to the <em>MMCalculations</em> tab and specify the necessary stream /
input files (consult the
<a class="reference external" href="http://ffparam.umaryland.edu/manual/workflow.html/">documentation</a> if
you are stuck) for an MM job. Choose <em>cartesian_geom</em> from the dropdown menu
again and check <em>Minimize</em>. Set OpenMM as the MD enginge on the right side of
the window and hit <em>Run MM</em>.</p>
<img alt="../_images/ffp4_hints.png" src="../_images/ffp4_hints.png" />
<p>You should do this for both the polarizable and the
non-polarizable stream files. If you see error messages, don’t panic - we only
need the .psf files created by <strong>ffparam</strong>, not the actual results of the
minimization.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For some atom types, the conversion to polarizable Drude-types doesn’t
always work perfectly out-of-the-box. If parameters, residues or atom types
are missing, download the latest version of the DGenFF stream files from the
homepage of the
<a class="reference external" href="http://mackerell.umaryland.edu/charmm_drude_ff.shtml">MacKerell group</a> and
specify these as the master <em>toppar</em> files.</p>
</div>
<p>If you have the intial coordinates for the non-polarizable and the optimized
coordinates for the polarizable stream files, then you can go ahead and start
using FFGenOpt.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="qm.html" class="btn btn-neutral float-left" title="Quantum Mechanics Setup" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ffgenopt.html" class="btn btn-neutral float-right" title="Using FFGenOpt" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Andras Szabadi, Aleksandar Doknic.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>